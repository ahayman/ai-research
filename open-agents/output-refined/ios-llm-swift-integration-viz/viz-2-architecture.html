<!-- Visualization: MLX Framework Architecture on iOS -->
<!-- Generated: 2025-12-22 -->
<!-- Type: architecture-diagram -->
<!-- Source: MLX Swift GitHub Repository -->

<figure class="data-viz" id="viz-2">
  <div class="viz-container" style="position: relative; width: 100%; max-width: 700px; margin: 0 auto;">
    <svg viewBox="0 0 600 450" xmlns="http://www.w3.org/2000/svg" style="width: 100%; height: auto;">
      <defs>
        <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#2563EB;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad3" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" style="stop-color:#8B5CF6;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
        </linearGradient>
        <linearGradient id="grad4" x1="0%" y1="0%" x2="0%" y2="100%">
          <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:1" />
          <stop offset="100%" style="stop-color:#D97706;stop-opacity:1" />
        </linearGradient>
        <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
          <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
        </filter>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
          <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
        </marker>
      </defs>

      <!-- Title -->
      <text x="300" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#1e293b">MLX Framework Architecture on iOS</text>

      <!-- Layer 1: Swift Application -->
      <rect x="100" y="55" width="400" height="60" rx="10" fill="url(#grad1)" filter="url(#shadow)"/>
      <text x="300" y="85" text-anchor="middle" fill="white" font-size="14" font-weight="bold">Swift Application Code</text>
      <text x="300" y="103" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="11">Your SwiftUI/UIKit App</text>

      <!-- Arrow 1 -->
      <line x1="300" y1="120" x2="300" y2="145" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowhead)"/>
      <text x="320" y="137" font-size="10" fill="#64748b">imports</text>

      <!-- Layer 2: MLX Swift API -->
      <rect x="100" y="150" width="400" height="60" rx="10" fill="url(#grad2)" filter="url(#shadow)"/>
      <text x="300" y="180" text-anchor="middle" fill="white" font-size="14" font-weight="bold">MLX Swift API (mlx-swift-lm)</text>
      <text x="300" y="198" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="11">MLXLLM, MLXLMCommon, ChatSession</text>

      <!-- Arrow 2 -->
      <line x1="300" y1="215" x2="300" y2="240" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowhead)"/>
      <text x="320" y="232" font-size="10" fill="#64748b">calls</text>

      <!-- Layer 3: MLX Core -->
      <rect x="100" y="245" width="400" height="60" rx="10" fill="url(#grad3)" filter="url(#shadow)"/>
      <text x="300" y="275" text-anchor="middle" fill="white" font-size="14" font-weight="bold">MLX Core (Metal GPU Acceleration)</text>
      <text x="300" y="293" text-anchor="middle" fill="rgba(255,255,255,0.8)" font-size="11">Array Operations, Neural Network Layers</text>

      <!-- Arrow 3 -->
      <line x1="300" y1="310" x2="300" y2="335" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowhead)"/>
      <text x="320" y="327" font-size="10" fill="#64748b">executes on</text>

      <!-- Layer 4: Apple Silicon -->
      <rect x="100" y="340" width="400" height="70" rx="10" fill="url(#grad4)" filter="url(#shadow)"/>
      <text x="300" y="368" text-anchor="middle" fill="white" font-size="14" font-weight="bold">Apple Silicon Hardware</text>

      <!-- Sub-components -->
      <rect x="120" y="378" width="100" height="25" rx="5" fill="rgba(255,255,255,0.2)"/>
      <text x="170" y="395" text-anchor="middle" fill="white" font-size="10">Unified Memory</text>

      <rect x="240" y="378" width="100" height="25" rx="5" fill="rgba(255,255,255,0.2)"/>
      <text x="290" y="395" text-anchor="middle" fill="white" font-size="10">Neural Engine</text>

      <rect x="360" y="378" width="100" height="25" rx="5" fill="rgba(255,255,255,0.2)"/>
      <text x="410" y="395" text-anchor="middle" fill="white" font-size="10">Metal GPU</text>

      <!-- Side annotation: Zero-copy -->
      <rect x="510" y="170" width="80" height="110" rx="8" fill="#f1f5f9" stroke="#e2e8f0" stroke-width="1"/>
      <text x="550" y="195" text-anchor="middle" font-size="10" fill="#64748b" font-weight="bold">Zero-Copy</text>
      <text x="550" y="210" text-anchor="middle" font-size="10" fill="#64748b" font-weight="bold">Data Flow</text>
      <line x1="530" y1="225" x2="530" y2="265" stroke="#10B981" stroke-width="2" stroke-dasharray="4"/>
      <line x1="570" y1="225" x2="570" y2="265" stroke="#10B981" stroke-width="2" stroke-dasharray="4"/>
      <circle cx="550" cy="250" r="8" fill="#10B981"/>
      <text x="550" y="254" text-anchor="middle" font-size="10" fill="white">0</text>

      <!-- Caption -->
      <text x="300" y="435" text-anchor="middle" font-size="11" fill="#64748b">Unified memory enables zero-copy operations between CPU, GPU, and Neural Engine</text>
    </svg>
  </div>
  <figcaption>
    <strong>Figure 2:</strong> MLX Framework Architecture showing the layered integration from Swift code to Apple Silicon hardware
    <span class="viz-source">Source: MLX Swift GitHub Repository</span>
  </figcaption>
</figure>

<style>
.data-viz {
  margin: 2rem 0;
  padding: 1.5rem;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.data-viz figcaption {
  text-align: center;
  margin-top: 1rem;
  font-size: 0.95rem;
  color: #475569;
}
.viz-source {
  display: block;
  font-size: 0.8rem;
  color: #94a3b8;
  margin-top: 0.5rem;
}
</style>
