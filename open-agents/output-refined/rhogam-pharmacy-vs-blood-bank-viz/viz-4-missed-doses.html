<!-- Visualization: Root Causes of Missed RhIG Administration -->
<!-- Generated: 2026-01-05 -->
<!-- Type: bar-chart -->
<!-- Source: PMC Article PMC9563491 -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Missed RhIG Root Causes</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .viz-container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.1);
      padding: 32px;
    }

    .viz-header {
      text-align: center;
      margin-bottom: 24px;
    }

    .viz-header h1 {
      font-size: 1.75rem;
      color: #1e3a5f;
      margin-bottom: 8px;
    }

    .viz-header p {
      color: #64748b;
      font-size: 0.95rem;
    }

    .chart-wrapper {
      position: relative;
      width: 100%;
      max-width: 700px;
      margin: 0 auto;
    }

    .stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      padding: 20px;
      border-radius: 12px;
      text-align: center;
      border: 1px solid #e2e8f0;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: #1e3a5f;
    }

    .stat-value.highlight {
      color: #dc2626;
    }

    .stat-value.success {
      color: #059669;
    }

    .stat-label {
      font-size: 0.85rem;
      color: #64748b;
      margin-top: 4px;
    }

    .insights {
      margin-top: 32px;
      padding: 20px;
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      border-radius: 12px;
      border-left: 4px solid #3b82f6;
    }

    .insights h3 {
      color: #1e40af;
      font-size: 1rem;
      margin-bottom: 12px;
    }

    .insights ul {
      list-style: none;
      padding: 0;
    }

    .insights li {
      padding: 8px 0;
      color: #1e40af;
      font-size: 0.9rem;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .insights li::before {
      content: 'â†’';
      color: #3b82f6;
      font-weight: bold;
    }

    .success-note {
      margin-top: 20px;
      padding: 16px;
      background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
      border-radius: 12px;
      border-left: 4px solid #059669;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .success-note svg {
      width: 32px;
      height: 32px;
      fill: #059669;
    }

    .success-note p {
      color: #047857;
      font-size: 0.9rem;
    }

    .source {
      text-align: center;
      margin-top: 24px;
      font-size: 0.8rem;
      color: #94a3b8;
    }

    @media (max-width: 600px) {
      .stats-row {
        grid-template-columns: 1fr;
      }

      .stat-value {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <figure class="viz-container" id="viz-4">
    <div class="viz-header">
      <h1>Why RhIG Doses Are Missed</h1>
      <p>Root cause analysis from study of 29,801 deliveries across two health systems</p>
    </div>

    <div class="stats-row">
      <div class="stat-card">
        <div class="stat-value">29,801</div>
        <div class="stat-label">Total Deliveries Studied</div>
      </div>
      <div class="stat-card">
        <div class="stat-value highlight">17</div>
        <div class="stat-label">Missed RhIG Doses</div>
      </div>
      <div class="stat-card">
        <div class="stat-value success">99.2%</div>
        <div class="stat-label">Prophylaxis Rate</div>
      </div>
    </div>

    <div class="chart-wrapper">
      <canvas id="missedDosesChart"></canvas>
    </div>

    <div class="insights">
      <h3>Key Insights for Prevention</h3>
      <ul>
        <li><strong>Missing Orders:</strong> Orders never placed due to amended infant blood type results or documentation gaps</li>
        <li><strong>Communication Barriers:</strong> Patient factors (limited English, hearing impairment) contributed to missed doses</li>
        <li><strong>Documentation Gaps:</strong> Providers manually verifying multiple data sources - neonatal labs, MAR, postpartum notes</li>
        <li><strong>Workflow Complexity:</strong> Average 27+ seconds required to look up and document all required information</li>
      </ul>
    </div>

    <div class="success-note">
      <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
      <p><strong>Solution:</strong> Implementation of an EHR toolkit with automated documentation and decision-support alerts achieved <strong>100% administration rate</strong> - zero additional missed doses after implementation.</p>
    </div>

    <figcaption class="source">
      <strong>Figure 4:</strong> Distribution of root causes for missed RhIG administration.<br>
      Source: PMC9563491 - Missed anti-D immune globulin administration study
    </figcaption>
  </figure>

  <script>
    const ctx = document.getElementById('missedDosesChart').getContext('2d');

    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: [
          'Missing Orders',
          'Communication Barriers',
          'Documentation Gaps',
          'Workflow Complexity'
        ],
        datasets: [{
          label: 'Number of Missed Doses',
          data: [5, 4, 4, 4],
          backgroundColor: [
            'rgba(220, 38, 38, 0.8)',
            'rgba(249, 115, 22, 0.8)',
            'rgba(234, 179, 8, 0.8)',
            'rgba(59, 130, 246, 0.8)'
          ],
          borderColor: [
            'rgb(220, 38, 38)',
            'rgb(249, 115, 22)',
            'rgb(234, 179, 8)',
            'rgb(59, 130, 246)'
          ],
          borderWidth: 2,
          borderRadius: 8,
          borderSkipped: false
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        indexAxis: 'y',
        plugins: {
          legend: {
            display: false
          },
          title: {
            display: true,
            text: 'Root Causes of 17 Missed RhIG Doses',
            font: {
              size: 16,
              weight: '600'
            },
            color: '#1e3a5f',
            padding: {
              bottom: 20
            }
          },
          tooltip: {
            backgroundColor: 'white',
            titleColor: '#1e3a5f',
            bodyColor: '#64748b',
            borderColor: '#e2e8f0',
            borderWidth: 1,
            padding: 12,
            displayColors: true,
            callbacks: {
              label: function(context) {
                const total = 17;
                const percentage = ((context.raw / total) * 100).toFixed(0);
                return `${context.raw} cases (${percentage}% of total)`;
              }
            }
          }
        },
        scales: {
          x: {
            beginAtZero: true,
            max: 6,
            ticks: {
              stepSize: 1,
              color: '#64748b'
            },
            grid: {
              color: '#f1f5f9'
            },
            title: {
              display: true,
              text: 'Number of Cases',
              color: '#64748b',
              font: {
                size: 12
              }
            }
          },
          y: {
            ticks: {
              color: '#1e3a5f',
              font: {
                weight: '500'
              }
            },
            grid: {
              display: false
            }
          }
        }
      }
    });
  </script>
</body>
</html>
